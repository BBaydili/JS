<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width">
    <link rel="icon" sizes="192x192" href="/JS/images/JS.png">
    <title>JS Teacher </title>

  <style>
    body { max-width: 640px; }
    textarea {
      width: 85%; 
      height:400px;
      resize: both;
    }
    iframe {
      width: 98%;
      height: 200px;
      resize: both;
      overflow: auto;
    }
  </style>
</head>

<body>

<h2 id=title></h2>

<textarea id="code">
<button onclick=setDate(Date())>
    Print date</button>
<button onclick=setDate("??")>
    Clear</button>
<button onclick=setColor("blue")>
    Blue</button>
<button onclick=setColor("green")>
    Green</button>
<p id=out></p>
<hr />

<script>
"use strict"
function setDate(s) {
    console.log("date: "+s);
    [s] = s.split(' GMT');
    out.innerText = "Date is "+s
}
function setColor(c) {
    console.log("color: "+c);
    out.style.color = c
}
setDate("??")
</script>
</textarea>

<button id=run>Run</button>
<br><br>
<iframe id="output"></iframe>
<hr />
<p>V0.3</p>

<script>
"use strict";
function doError(message, source, lineno, colno, error) {
    console.error(message, lineno, colno);
    let a = code.value.split('\n').map(x => x.length+1)
    // console.log(a)
    let k = 0; lineno-- //starts at 1
    for (let n=0; n<lineno; n++) k += a[n]
    // console.log(k, a[lineno])
    code.selectionStart = k
    code.selectionEnd = k + a[lineno]
    code.focus()
    return true
}
    title.innerText = document.title
    const onload 
      = () => {output.contentWindow.onerror = doError}
    run.onclick = () => {
        output.srcdoc = code.value;
        setTimeout(onload, 10)
    }
    run.click()
</script>

</body>
</html>
